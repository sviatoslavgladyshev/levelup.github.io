<!DOCTYPE html>
<html>
<head>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
</head>
<body>
    <h2>Sign Up</h2>
    <form id="sign-up-form">
        <input type="text" id="company_name" placeholder="Company Name" required>
        <input type="email" id="email" placeholder="Email" required>
        <input type="password" id="password" placeholder="Password" required minlength="8">
        <input type="text" id="phone" placeholder="Phone Number" required pattern="\+1\d{10}" title="Phone number must start with +1 followed by ten digits">
        <input type="text" id="address" placeholder="Address" required>
        <input type="text" id="city" placeholder="City" required>
        <select id="state" required>
            <option value="">Select State</option>
            <option value="state1">State 1</option>
            <option value="state2">State 2</option>
            <!-- Add more options as needed -->
        </select>
        <input type="text" id="zipcode" placeholder="Zip Code" required pattern="\d{5}" title="Five digit zip code">
        <select id="industry" required>
            <option value="">Select Industry</option>
            <option value="industry1">Industry 1</option>
            <option value="industry2">Industry 2</option>
            <!-- Add more options as needed -->
        </select>
        <input type="checkbox" id="agree" name="agree" required>
        <label for="agree">I agree with the Privacy Policy and Terms of Service</label>
        <button type="submit">Sign Up</button>
    </form>

    <script>
        // Initialize Firebase
        var firebaseConfig = {
            apiKey: "AIzaSyDWXpvIim5vIzo-mMJvojHF5sJ04WgBvSA",
            authDomain: "levelup-65b5b.firebaseapp.com",
            projectId: "levelup-65b5b",
            storageBucket: "levelup-65b5b.appspot.com",
            messagingSenderId: "13469845736",
            appId: "1:13469845736:web:aa4b300ead478eac30215d"
        };
        firebase.initializeApp(firebaseConfig);

        const auth = firebase.auth();
        const db = firebase.firestore();

        const signUpForm = document.getElementById('sign-up-form');
        signUpForm.addEventListener('submit', (e) => {
            e.preventDefault();

            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;
            const address = document.getElementById('address').value;
            const city = document.getElementById('city').value;
            const zipcode = document.getElementById('zipcode').value;
            const phone = document.getElementById('phone').value;
            const company_name = document.getElementById('company_name').value;
            const state = document.getElementById('state').value;
            const industry = document.getElementById('industry').value;
            const agree = document.getElementById('agree').checked;

            auth.createUserWithEmailAndPassword(email, password)
                .then((cred) => {
                    localStorage.setItem('userID', cred.user.uid);
                    // Send email verification
                    return cred.user.sendEmailVerification().then(() => {
                        // Update user data in Firestore
                        return db.collection('employers').doc(cred.user.uid).set({
                            email: email,
                            address: address,
                            city: city,
                            zipcode: zipcode,
                            phone: phone,
                            company_name: company_name,
                            state: state,
                            industry: industry,
                            agree: agree
                        });
                    }).then(() => {
                        // Redirect after verification email is sent
                        window.location.assign('profile.html');
                    }).catch((error) => {
                        console.error("Error sending email verification:", error);
                        alert("Error: Unable to send email verification. Please try again later.");
                    });
                }).catch((error) => {
                    console.error("Error creating user:", error);
                    alert("Error: Unable to create user. Please try again later.");
                });
        });
    </script>
</body>
</html>
